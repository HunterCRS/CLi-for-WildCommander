;GS Player Example Plugin;(C) BUDDER/MGN/2013;---------------------------------------        ORG #6000;-------ABT     EQU #6004ENT     EQU #6005WLD     EQU #6006;---------------------------------------;HEADER:        DS 16        DB "WildCommanderMDL";    Header        DB #02;                  Version        DB 0;                       Type        DB 1; Pages        DB 0; Page to #8000;-------        DB 0,8; CODE.5      DB 0,0;-------        DS 16;-------        DB "MOD"        DS 31*3;-------        DB 0;-------        DW #FFFF,#FFFF; MAX SIZE;-------        DB "Hi Breeze!      "        DB "                ";-------        DB 0;---------------------------------------        ORG #8000,#6200;-------LOBU    EQU #A000;---------------------------------------PLUGIN  LD (DAHL),HL,(DADE),DE        LD L,H,H,E.3      SRL D:RR H,L        INC L:JR NZ,$+3:INC H        LD (BLKZ),HL        XOR A:LD (ESTAT),A        CALL DEVCHE:RET Z        LD A,(GSENA):CP #FF:CALL Z,GSFET        LD A,(GSENA):OR A:JP NZ,NOGS        CALL GEDPL        LD IX,PLWND:CALL PRWOW;-------MODMUZ  CALL GOGS        XOR A:LD (ZNAK),A,(POZA),AMAIN    EI:HALT        CALL GWC,NC,PTC:JR NC,NEXT        CALL SPKE:JR NZ,GAFF        CALL ESC:JR NZ,MGAFF        CALL ENKE:JR Z,MAIN        CALL MUTEGSNEXT    LD A,2,(ESTAT),AGAFF    LD IX,PLWND:CALL RRESBGAF     LD A,(ESTAT)        RET;-------MGAFF   CALL MUTEGS:JR GAFF;-------NOGS    LD A,1,(ESTAT),A:JR GAF;---------------------------------------;---------------------------------------PTC     LD HL,ZNAK        LD A,(HL):OR A:JR NZ,NNC        LD A,#60:OUT (#BB),A        LD (HL),APOF     SCF        RETNNC     LD (HL),0        IN A,(#B3)        LD HL,POZA        CP (HL):LD (HL),A:JR NC,POF        XOR A        RET;---------------------------------------GOGS    XOR A:CALL SENDCOM        LD A,#F3:CALL SENDCOM;REini        LD A,#23:CALL SENDCOM,GETDAT        EXA        LD A,#30:CALL SENDCOM;sndMOD        LD A,#D1:CALL SENDCOM;opnSTRM        EXA        LD DE,6,H,D,L,A.4      ADD HL,HL        ADD HL,DE        LD A,(BLKZ+1):CP H        JR NZ,ZEM        LD B,A:LD A,(BLKZ):CP L:LD A,B        JR Z,NOIZEM     JR NC,BRKANOI     OR A:JR Z,NANOIR    PUSH AF        LD B,0:CALL GSLOAD        POP AF        DEC A:JR NZ,NOIRNA      LD A,(BLKZ),B,A        CALL GSLOAD        LD A,#D2:CALL SENDCOM        IN A,(#B3):OUT (#B3),A        LD A,#31:CALL SNDCOM;-------        CALL GIPAGPL        LD HL,LOBU,B,2:CALL LOAD512        LD A,(LOBU+950),(POZS),A        RETBRKA    LD A,#D2:CALL SENDCOM        RET;---------------------------------------GSLOAD  PUSH BC        LD HL,LOBU,B,4:CALL LOAD512        LD HL,LOBU        LD BC,#00BB,E,2TE1     IN A:RLCA:JR C,TE1RDA     LD A,(HL):OUT (#B3),A:INC LTE2     IN A:RLCA:JR C,TE2RDB     LD A,(HL):OUT (#B3),A:INC LTE3     IN A:RLCA:JR C,TE3RDC     LD A,(HL):OUT (#B3),A:INC LTE4     IN A:RLCA:JR C,TE4RDD     LD A,(HL):OUT (#B3),A:INC HL        DJNZ TE1        DEC E:JR NZ,TE1        POP BC        DJNZ GSLOAD        RET;-------SNDCOM  OUT (#BB),A:RETSENDCOM OUT (#BB),AGSWC    IN A,(#BB)        RRCA        JR C,GSWC        RETGWC     IN A,(#BB)        RRCA        RET;-------SENDDAT OUT (#B3),AGSWD    IN A,(#BB):RLCA:JR C,GSWD        RET;-------GETDAT  IN A,(#BB):RLCA:JR NC,GETDAT        IN A,(#B3)        RET;---------------------------------------;Detecting GS/NGS:GSFET   LD A,#80:OUT (#33)        LD B,32:EI:HALT:DJNZ $-2        IN A,(#B3)        LD B,0,C,ASTAB    IN A,(#B3):CP C:JR NZ,WSE        DJNZ STAB;LD A,#F3:OUT (#BB),A;LD B,0:DJNZ $        LD A,#23:OUT (#BB),A        LD BC,#0F00DIK     DEC BC:LD A,B:OR C:JR Z,WSE        IN A,(#BB)        RRCA        JR C,DIK        IN A,(#B3):CP 3:JR C,WSEWNE     LD A,1:OUT (#B3),A        LD A,#6A:CALL SENDCOM        XOR A:OUT (#B3),A        LD A,#6B:CALL SENDCOM        XOR A;-------WZE     LD (GSENA),A        PUSH AF:LD A,#F3:CALL SNDCOM        POP AF        RETWSE     LD A,1:OR A        JR WZE;-------MUTEGS  LD A,#F3:OUT (#BB):RET;---------------------------------------TN_LD A,(DE):CP (HL):RET NZ:INC HL,DE_LD A,(DE):CP (HL):RET NZ:INC HL,DE_LD A,(DE):CP (HL)        RET;---------------------------------------DEVCHE  LD A,(IX+29):CP 2:RET NZ        CALL GEDPL        LD IX,ERWND:CALL PRWOW_LD HL,TXTER,DE,#0103,BC,26:CALL PRSRW        CALL USPO        CALL NUSP        CALL RRESB        XOR A        RET;---------------------------------------PRWOW   LD A,1:JP WLDRRESB   LD A,2:JP WLDPRSRW   LD A,3:JP WLDPRIAT   EXA:LD A,4:JP WLD;-------GEDPL   LD A,15:JP WLD;-------SPKE    LD A,16:JP WLDENKE    LD A,22:JP WLDESC     LD A,23:JP WLDUSPO    LD A,46:JP WLDNUSP    LD A,47:JP WLD;-------LOAD512 LD A,48:JP WLDGIPAGPL LD A,50:JP WLDTENTRY  LD DE,ENTRY,A,51:JP WLD;---------------------------------------PLWND   DB 0,0        DB 23,13;    X,Y        DB 32+2,2+2; W,H        DB %01111111;PAPER+INK        DB 0        DW #0000;    BUFFER        DB 0,0;      LINES;-------ERWND   DB 0,0        DB 23,13;    X,Y        DB 32+2,1+2; W,H        DB %00101111;PAPER+INK        DB 0        DW #0000;    BUFFER        DB 0,0;      LINES;-------TXTER   DB "CAN'T PLAY FROM SD(NGS)!!!";---------------------------------------MOD     DB "MOD";-------DAHL    DS 2DADE    DS 2BLKZ    DS 2GSENA   DB #FFMINB    NOPZNAK    NOPPOZA    NOP ;POS NOWPOZS    NOP ;POSITIONSWVMD    NOP;-------ESTAT   NOP;---------------------------------------ENTRY   DS 32END;---------------------------------------